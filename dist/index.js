(function(f,r){typeof exports=="object"&&typeof module!="undefined"?module.exports=r(require("highlight.js"),require("painter-kernel")):typeof define=="function"&&define.amd?define(["highlight.js","painter-kernel"],r):(f=typeof globalThis!="undefined"?globalThis:f||self).phl=r(f.hljs,f.painter)})(this,function(f,r){"use strict";function v(h){return h&&typeof h=="object"&&"default"in h?h:{default:h}}var A=v(f);return function(h,P,s,q,z){let d=[],j={default:{color:"#55b5db"},property:{color:"#a074c4"},comment:{color:"#41535b"},literal:{color:"#ee3300ef"},doctag:{color:"#ff7b72"},built_in:{color:"#55b5db"},keyword:{color:"#e6cd69"},"template-tag":{color:"#ff7b72"},"template-variable":{color:"#9fca56"},type:{color:"#9fca56"},string:{color:"#55b5db"},attr:{color:"#ff7b72"},number:{color:"#cd3f45"},params:{color:"#55b5db"},"variable.language":{color:"#55b5db"},"variable.constant":{color:"#55b5db"},subst:{color:"Purple"},title:{color:"#d2a8ff"},"title.class":{color:"#df88df"},"title.class.inherited":{color:"#dda8ff"},"title.function":{color:"#a074c4"},deletion:{color:"#ffdcd7",backgroundColor:"#67060c"},addition:{color:"#aff5b4",backgroundColor:"#033a16"},strong:{color:"#c9d1d9",fontWeight:"bold"},emphasis:{color:"#c9d1d9",fontStyle:"italic"},sign:{color:"#eee"},attribute:{color:"#9fca56"}};const p=new Map(Object.entries(j));let i=[];const n=RegExp(/\n/g),a=RegExp(/([^\s])/g),w=RegExp(/([\s])/g),m=RegExp(/\t/g);let x=0,_=0,g=0,u=0,C=["#E0443E","#DEA123","#1AAB29"],E=0,b=0,y=q.split(`
`).map((t,l)=>{let c,o=t.match(w)?.length;if(o===void 0&&(o=0),c=t.match(a)?.length+o+(t.match(m)?.length?t.match(m)?.length:0),t.match(w)&&t.match(a)?.length){let k=t.indexOf(t.match(a)[0]);t=t.slice(0,k)+t.slice(0,k)+t.slice(k)}return typeof t=="string"&&t.match(m)&&(t=t.replace(m,"  ")),b<c&&(b=c||0),E++,t}).join(`
`);y=`
`+y;let e=A.default.highlight(y,{language:z})._emitter.root.children;const O=t=>{let l=t,c=t.match(n);if(t.match(/\)/)){let o=t.indexOf(")");i.push(t.slice(0,o)),l=t.slice(o)}if(c!==null)for(;c.length;){let o=l.indexOf(c[0]);l.slice(0,o)&&i.push(l.slice(0,o)),i.push(l.slice(o,o+1)),l=l.slice(o+1),c.shift()}i.push(l)};for(let t=0;t<e.length;t++)if(typeof e[t]=="string")if(e[t].match(n)&&e[t].match(a))O(e[t]);else if(e[t].match(/\]/)){let l=e[t].indexOf("]");if(e[t].match(/\)/)){let c=e[t].indexOf(")");i.push(e[t].slice(0,l),e[t].slice(l,c),e[t].slice(c))}else i.push(e[t].slice(0,l),e[t].slice(l))}else if(e[t].match(/\)/)){let l=e[t].indexOf(")");i.push(e[t].slice(0,l),e[t].slice(l))}else i.push(e[t]);else if(e[t].kind==="comment")i.push(e[t]);else if(e[t].kind==="property"&&e[t].children[0].children)i.push(e[t].children[0].children[0]);else if(e[t].children.length>1){let l=e[t].children;for(let c of l)if(typeof c=="string"&&c.match(/\)/)?.length){let o=c.indexOf(")");i.push(c.slice(0,o+1)),i.push(c.slice(o+1))}else i.push(c)}else e[t].kind==="params"&&typeof e[t].children[0]=="object"&&e[t].children[0].kind!=="regexp"?O(e[t].children[0]):i.push(e[t]);let R=[];i.forEach(t=>{t!==""&&R.push(t)}),e=R;for(let t=0;t<e.length;t++){let l={id:"hl0_"+t,text:"",type:"text",css:{top:"calc(hl0_"+(t-1)+".top)",left:"calc(hl0_"+(t-1)+".right)",color:j.default.color,fontSize:"19px"}};if(typeof e[t]=="object"){let c;e[t].children.length?(l.text=e[t].children.join(""),l.css.left="calc(hl0_"+(t-1)+".right + 1px)",c=p.get(e[t].kind)):(l.text=e[t].children,l.css.left="calc(hl0_"+(t-1)+".right - 5px)",c=p.get(e[t].kind)),(g||u)&&(e[t]!==";"&&(l.css.left="calc(hl0_"+(t-1)+".right - 8px)"),g=0,u=0),e[t].children.length&&e[t].children[0].kind!=="regexp"&&e[t].children[0].match!==null&&e[t].children[0]?.match(/\/\*\*/g)&&(_+=e[t].children[0].match(n)?.length?e[t].children[0].match(n)?.length:0),l.css.color=c?c.color:p.get("default").color}else if(typeof e[t]=="string")if(l.text=e[t],e[t].match(RegExp(/^[a-zA-Z]/g))?l.css.color=p.get("string").color:e[t].match(RegExp(/=/g))?l.css.color=p.get("attribute").color:(e[t].match(a)!==null&&e[t].match(a).length!==1&&(b+=.6*e[t].match(a).length),l.css.color=p.get("sign").color),l.css.left="calc(hl0_"+(t-1)+".right + 2px)",(g||u)&&(e[t]!==";"&&(l.css.left="calc(hl0_"+(t-1)+".right - 10px)"),g=0,u=0),e[t].match(n)&&!e[t].match(/\`/g))x=e[t].match(n).length;else if(e[t]===" ")l.css.left="calc(hl0_"+(t-1)+".right - 8px)";else if(e[t].match(/\(/)||e[t].match(/\[/)||e[t].match(/\{/)){switch(e[t-1]){case"(":case"[":case"{":l.css.left="calc(hl0_"+(t-1)+".right - 10px)";break;case" ":l.css.left="calc(hl0_"+(t-1)+".right - 5px)";break;default:l.css.left="calc(hl0_"+(t-1)+".right + 3px)"}g=1}else e[t]!=")"&&e[t]!="]"&&e[t]!="}"||(e[t-1]=="}"&&(l.css.left="calc(hl0_"+(t-1)+".right - 9px)"),u=1);x&&(l.css.top="calc(hl0_"+(t-1)+".top +"+23*(x+_)+" px)",l.css.left="0",e[t].match(n)&&e[t].slice(2)&&(l.css.left="calc(hl0_0.right)"),x=0,_=0),d.push(l)}d[0].css.top="55px",d[1].css.left="calc(hl0_0.right + 0px)",d[0].css.left="0";for(let t=0;t<3;t++){let l={id:"hl1_"+t,type:"rect",css:{top:"18px",left:18+20*t+"px",height:"12px",width:"12px",color:C[t],borderRadius:"50%"}};d.unshift(l)}s.height=="auto"&&(s.height=23*E+55+"px"),s.width=="auto"&&(s.width=12*b+"px"),h.width=r.toPx(s.width),h.height=r.toPx(s.height),s.views=d,new r.Pen(P,s).paint()}});
